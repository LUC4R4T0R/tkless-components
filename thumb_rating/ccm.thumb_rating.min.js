(function(){var component={name:"thumb_rating",ccm:"https://akless.github.io/ccm/ccm.js",config:{data:{store:["ccm.store",{}]},templates:{simple:{class:"rating",inner:{inner:[{class:"likes fa fa-lg fa-thumbs-up",inner:"%likes%"},{class:"dislikes fa fa-lg fa-thumbs-down",inner:"%dislikes%"}]}},buttons:{class:"rating",inner:{inner:[{tag:"a",href:"#",class:"likes btn btn-default",inner:[{tag:"i",class:"fa fa-thumbs-up icon"},"%likes%"]},{tag:"a",href:"#",class:"dislikes btn btn-default",inner:[{tag:"i",class:"fa fa-thumbs-down icon"},"%dislikes%"]}]}}},libs:["ccm.load",{context:"head",url:"https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"},"https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css",{context:"head",url:"../../ccm-components/libs/bootstrap/css/bootstrap.css"},"../../ccm-components/libs/bootstrap/css/bootstrap.css","../../../ccm-components/thumb_rating/resources/default.css"]},Instance:function(){var self=this;var total=0;this.init=function(callback){self.data.store.onChange=function(){self.start()};callback()};this.ready=function(callback){if(self.user)self.user.addObserver(self.index,function(event){if(event)self.start()});if(self.logger)self.logger.log("ready",{key:self.data.key,store:self.data.store.source()});callback()};this.start=function(callback){self.ccm.helper.dataset(self.data.store,self.data.key,function(dataset){if(self.logger)self.logger.log("start",dataset);renderThumbs();function renderThumbs(){if(!dataset.likes)dataset.likes={};if(!dataset.dislikes)dataset.dislikes={};total=Object.keys(dataset.likes).length-Object.keys(dataset.dislikes).length;if(self.buttons)self.ccm.helper.setContent(self.element,self.ccm.helper.html(self.templates.buttons,{likes:Object.keys(dataset.likes).length,dislikes:Object.keys(dataset.dislikes).length}));else self.ccm.helper.setContent(self.element,self.ccm.helper.html(self.templates.simple,{likes:Object.keys(dataset.likes).length,dislikes:Object.keys(dataset.dislikes).length}));if(!self.user)return;var div={likes:self.element.querySelector(".likes"),dislikes:self.element.querySelector(".dislikes")};self.element.querySelector(".rating").classList.add("user");if(self.user.isLoggedIn()){var user=self.user.data().name;if(dataset.likes[user])div["likes"].classList.add("selected");if(dataset.dislikes[user])div["dislikes"].classList.add("selected")}click("likes","dislikes");click("dislikes","likes");function click(index,other){div[index].addEventListener("click",function(){self.user.login(function(){var user=self.user.data().name;if(dataset[index][user]){delete dataset[index][user]}else{dataset[index][user]=true;delete dataset[other][user]}self.data.store.set(dataset,function(){if(self.logger)self.logger.log("click",index);self.start()})})})}}if(callback)callback()})};this.getValue=function(){return total}}};function p(){window.ccm[v].component(component)}var f="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[f])window.ccm.files[f]=component;else{var n=window.ccm&&window.ccm.components[component.name];n&&n.ccm&&(component.ccm=n.ccm),"string"==typeof component.ccm&&(component.ccm={url:component.ccm});var v=component.ccm.url.split("/").pop().split("-");if(v.length>1?(v=v[1].split("."),v.pop(),"min"===v[v.length-1]&&v.pop(),v=v.join(".")):v="latest",window.ccm&&window.ccm[v])p();else{var e=document.createElement("script");document.head.appendChild(e),component.ccm.integrity&&e.setAttribute("integrity",component.ccm.integrity),component.ccm.crossorigin&&e.setAttribute("crossorigin",component.ccm.crossorigin),e.onload=function(){p(),document.head.removeChild(e)},e.src=component.ccm.url}}})();