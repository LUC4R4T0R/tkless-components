(()=>{const component={name:"pdf_viewer",version:[7,0,0],ccm:"https://ccmjs.github.io/ccm/versions/ccm-27.1.1.min.js",config:{css:["ccm.load","https://ccmjs.github.io/tkless-components/pdf_viewer/resources/styles.min.css","https://ccmjs.github.io/tkless-components/libs/bootstrap-5/css/bootstrap-icons.min.css",{url:"https://ccmjs.github.io/tkless-components/libs/bootstrap-5/css/bootstrap-fonts.min.css",context:"head"}],downloadable:true,helper:["ccm.load","https://ccmjs.github.io/akless-components/modules/versions/helper-7.7.0.mjs"],html:["ccm.load","https://ccmjs.github.io/tkless-components/pdf_viewer/resources/templates.mjs"],pdf:"https://ccmjs.github.io/tkless-components/pdf_viewer/resources/slides.pdf",pdfjs:{lib:["ccm.load","https://ccmjs.github.io/tkless-components/libs/pdfjs/pdf.min.js"],worker:"https://ccmjs.github.io/tkless-components/libs/pdfjs/pdf.worker.min.js",namespace:"pdfjs-dist/build/pdf"},text:{denied:"Access Denied",download:"Download PDF",first:"First Page",jump:"Jump to specific Page",last:"Last Page",next:"Next Page",prev:"Previous Page",protected:"This document is password protected. Enter a password."},touchable:true},Instance:function(){let $;let file;let page_nr=1;let rendering=false;this.init=(async()=>{$=Object.assign({},this.ccm.helper,this.helper);$.use(this.ccm);const pdfjs=window[this.pdfjs.namespace];if(!pdfjs.GlobalWorkerOptions.workerSrc)pdfjs.GlobalWorkerOptions.workerSrc=this.pdfjs.worker;this.pdfjs=pdfjs});this.ready=(async()=>this.logger&&this.logger.log("ready",$.privatize(this,true)));this.start=(async()=>{try{file=await this.pdfjs.getDocument(this.pdf).promise}catch(exception){if(exception.name!=="PasswordException")return;try{file=await this.pdfjs.getDocument({url:this.pdf,password:prompt(this.text.protected)}).promise}catch(e){}if(!file)return $.setContent(this.element,this.text.denied)}this.logger&&this.logger.log("start");render();const canvas=this.element.querySelector("canvas");!this.downloadable&&canvas.addEventListener("contextmenu",event=>event.preventDefault());if(this.routing&&this.routing.get())page_nr=this.routing.get().split("-")[1];else await renderPage();if(this.touchable){let reachedEdge=false;let touchStart=null;let touchDown=false;canvas.addEventListener("touchstart",()=>touchDown=true);canvas.addEventListener("touchmove",event=>{if(canvas.scrollLeft===0||canvas.scrollLeft===canvas.scrollWidth-canvas.clientWidth)reachedEdge=true;else{reachedEdge=false;touchStart=null}if(reachedEdge&&touchDown){if(touchStart===null)touchStart=event.changedTouches[0].clientX;else{let distance=event.changedTouches[0].clientX-touchStart;if(distance<-100){touchStart=null;reachedEdge=false;touchDown=false;events.onNext()}else if(distance>100){touchStart=null;reachedEdge=false;touchDown=false;events.onPrev()}}}});canvas.addEventListener("touchend",()=>{touchStart=null;touchDown=false})}this.routing&&this.routing.define({page:number=>{page_nr=number;renderPage()}})});this.goTo=(async page=>{if(page<1||page>file.numPages)return;page_nr=page;await renderPage();this.logger&&this.logger.log("goto",page_nr)});this.getPage=(()=>page_nr);this.getPages=(()=>file.numPages);this.onbreakpoint=(()=>renderPage());const render=()=>this.html.render(this.html.main(this,events,page_nr,file.numPages),this.element);const renderPage=async()=>{if(rendering)return;rendering=true;await $.sleep(30);const canvas=this.element.querySelector("canvas");const page=await file.getPage(page_nr);const viewport=page.getViewport({scale:canvas.clientWidth/page.getViewport({scale:1}).width});canvas.height=viewport.height;canvas.width=viewport.width;await render();await page.render({canvasContext:canvas.getContext("2d"),viewport:viewport}).promise;rendering=false;this.routing&&this.routing.set("page-"+page_nr)};const events={onFirst:async()=>{if(this.onchange&&await this.onchange({name:"first",page:page_nr,instance:this,before:true}))return;if(page_nr<=1)return;await this.goTo(page_nr=1);this.onchange&&this.onchange({name:"first",page:page_nr,instance:this})},onPrev:async()=>{if(this.onchange&&await this.onchange({name:"prev",page:page_nr,instance:this,before:true}))return;if(page_nr<=1)return;await this.goTo(--page_nr);this.onchange&&this.onchange({name:"prev",page:page_nr,instance:this})},onJump:async event=>{const page=parseInt(event.target.value);event.target.value="";if(this.onchange&&await this.onchange({name:"jump",page:page,instance:this,before:true}))return;if(!page||page<1||page>file.numPages||page===page_nr)return;await this.goTo(page);this.onchange&&this.onchange({name:"jump",page:page,instance:this})},onNext:async()=>{if(this.onchange&&await this.onchange({name:"next",page:page_nr,instance:this,before:true}))return;if(page_nr>=file.numPages)return;await this.goTo(++page_nr);this.onchange&&this.onchange({name:"next",page:page_nr,instance:this})},onLast:async()=>{if(this.onchange&&await this.onchange({name:"last",page:page_nr,instance:this,before:true}))return;if(page_nr>=file.numPages)return;await this.goTo(page_nr=file.numPages);this.onchange&&this.onchange({name:"last",page:page_nr,instance:this})}}}};let b="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[b])return window.ccm.files[b]=component;(b=window.ccm&&window.ccm.components[component.name])&&b.ccm&&(component.ccm=b.ccm);"string"===typeof component.ccm&&(component.ccm={url:component.ccm});let c=(component.ccm.url.match(/(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)/)||[""])[0];if(window.ccm&&window.ccm[c])window.ccm[c].component(component);else{var a=document.createElement("script");document.head.appendChild(a);component.ccm.integrity&&a.setAttribute("integrity",component.ccm.integrity);component.ccm.crossorigin&&a.setAttribute("crossorigin",component.ccm.crossorigin);a.onload=function(){(c="latest"?window.ccm:window.ccm[c]).component(component);document.head.removeChild(a)};a.src=component.ccm.url}})();