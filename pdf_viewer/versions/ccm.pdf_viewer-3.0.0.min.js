{var component={name:"pdf_viewer",version:[3,0,0],ccm:{url:"https://ccmjs.github.io/ccm/versions/ccm-16.6.0.js",integrity:"sha256-9U5Q2yiY5v1Tqp8ZJjCRnZrG8T1B14LdVf/PWOOUycE= sha384-LcGBJPmX/Aq5Jkre3q9yE+UCsd7vPWIgeBb9ayc4TIAl5H1nJpewlkKCDK8eCc7s sha512-YANGRGQdJYghxk/7O2bIMsT+XOJ1fzE6Lc6zGJxG+GsdMKznGTdZ8z3d+fnrvqOeEl6qmqxkIP6DueDq2dG0rw==",crossorigin:"anonymous"},config:{html:{main:{id:"pdf-viewer",class:"container-fluid",inner:[{id:"pdf-elem",inner:{id:"pdf-view",inner:{id:"canvas",tag:"canvas"}}},{id:"nav",inner:[{class:"input-group",inner:[{class:"input-group-btn",inner:{class:"btn btn-prev btn-info",onclick:"%prev%",inner:"Prev"}},{id:"page-num",style:"padding: 0 0 !important",class:"form-control text-center",tag:"input",type:"number",min:"1",max:"%all%",onchange:"%go_to%"},{class:"input-group-btn",inner:{class:"btn btn-next btn-warning",onclick:"%next%",inner:"Next"}}]}]}]}},pdfJS:["ccm.load","https://ccmjs.github.io/tkless-components/libs/pdfjs/pdf.js"],pdfJS_workerSrc:["ccm.load","https://ccmjs.github.io/tkless-components/libs/pdfjs/pdf.worker.js"],css:["ccm.load","https://ccmjs.github.io/tkless-components/libs/bootstrap/css/bootstrap.css",{context:"head",url:"https://ccmjs.github.io/tkless-components/libs/bootstrap/css/font-face.css"},"https://ccmjs.github.io/tkless-components/pdf_viewer/resources/default.css"]},Instance:function(){const self=this;let my;let $;let pdfDoc,pageNum,pageRendering,pageNumPending,ctx;let file;this.init=callback=>{file=self.pdf;pdfDoc=null;pageNum=1;pageRendering=false;pageNumPending=null;callback()};this.ready=callback=>{$=self.ccm.helper;my=$.privatize(self);if(self.logger)self.logger.log("ready",my);PDFJS.workerSrc=my.pdfJS_workerSrc;if($.isObject(my.pdf)&&my.pdf.slides)my.pdf=my.pdf.slides[0].data;PDFJS.disableStream=true;if(my.pdf)PDFJS.getDocument(my.pdf).then((function(pdf){pdfDoc=pdf;callback()}));else callback()};this.start=callback=>{if(self.logger)self.logger.log("start");if(!my.pdf){$.setContent(self.element,"No File to Display");return callback&&callback()}$.setContent(self.element,$.html(my.html.main,{prev:function(){self.element.querySelector(".btn-next").classList.remove("active");self.element.querySelector(".btn-prev").classList.add("active");onPrevPage()},next:function(){self.element.querySelector(".btn-prev").classList.remove("active");self.element.querySelector(".btn-next").classList.add("active");onNextPage()},go_to:function(){goTo(self.element.querySelector("#page-num").value);self.element.querySelector("#page-num").value=""},all:function(){pdfDoc.numPages}}));const canvas=self.element.querySelector("canvas");canvas.addEventListener("contextmenu",(event=>{event.preventDefault()}));ctx=canvas.getContext("2d");let page_elem=self.element.querySelector("#pdf-view");renderPage(pageNum);touchEventHandling();if(callback)callback();function renderPage(num){pageRendering=true;pdfDoc.getPage(num).then((function(page){let viewport=page.getViewport(1);let scale=page_elem.clientWidth/viewport.width;viewport=page.getViewport(scale);canvas.height=viewport.height;canvas.width=viewport.width;let renderContext={canvasContext:ctx,viewport:viewport};let renderTask=page.render(renderContext);renderTask.promise.then((function(){pageRendering=false;if(pageNumPending!==null){renderPage(pageNumPending);pageNumPending=null}if(pdfDoc.numPages>1){self.element.querySelector("#nav").style.width=self.element.querySelector("#canvas").offsetWidth+"px";self.element.querySelector("#page-num").placeholder=num+" / "+pdfDoc.numPages}else self.element.querySelector("#nav").remove()}))}),(function(err){console.log(err)}))}function touchEventHandling(){let reachedEdge=false;let touchStart=null;let touchDown=false;page_elem.addEventListener("touchstart",(function(){touchDown=true}));page_elem.addEventListener("touchmove",(function(event){if(page_elem.scrollLeft===0||page_elem.scrollLeft===page_elem.scrollWidth-page_elem.clientWidth){reachedEdge=true}else{reachedEdge=false;touchStart=null}if(reachedEdge&&touchDown){if(touchStart===null){touchStart=event.changedTouches[0].clientX}else{let distance=event.changedTouches[0].clientX-touchStart;if(distance<-100){touchStart=null;reachedEdge=false;touchDown=false;onNextPage()}else if(distance>100){touchStart=null;reachedEdge=false;touchDown=false;onPrevPage()}}}}));page_elem.addEventListener("touchend",(function(){touchStart=null;touchDown=false}))}function queueRenderPage(num){if(pageRendering){pageNumPending=num}else{renderPage(num);self.element.querySelector("#nav").style.width=self.element.querySelector("#canvas").offsetWidth+"px"}}function goTo(page){if(page>pdfDoc.numPages||page<1)return;pageNum=page;queueRenderPage(parseInt(pageNum));if(self.logger)self.logger.log("goto",parseInt(page))}function onPrevPage(){if(pageNum<=1){return}pageNum--;queueRenderPage(pageNum);if(self.logger)self.logger.log("prev",pageNum)}function onNextPage(){if(pageNum>=pdfDoc.numPages){return}pageNum++;queueRenderPage(pageNum);if(self.logger)self.logger.log("next",pageNum)}}}};function p(){window.ccm[v].component(component)}const f="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[f])window.ccm.files[f]=component;else{const n=window.ccm&&window.ccm.components[component.name];n&&n.ccm&&(component.ccm=n.ccm),"string"==typeof component.ccm&&(component.ccm={url:component.ccm});var v=component.ccm.url.split("/").pop().split("-");if(v.length>1?(v=v[1].split("."),v.pop(),"min"===v[v.length-1]&&v.pop(),v=v.join(".")):v="latest",window.ccm&&window.ccm[v])p();else{const e=document.createElement("script");document.head.appendChild(e),component.ccm.integrity&&e.setAttribute("integrity",component.ccm.integrity),component.ccm.crossorigin&&e.setAttribute("crossorigin",component.ccm.crossorigin),e.onload=function(){p(),document.head.removeChild(e)},e.src=component.ccm.url}}}
//# sourceMappingURL=ccm.pdf_viewer-3.0.0.min.js.map