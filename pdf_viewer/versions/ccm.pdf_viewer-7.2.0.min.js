(()=>{const component={name:"pdf_viewer",version:[7,2,0],ccm:"https://ccmjs.github.io/ccm/versions/ccm-27.2.0.min.js",config:{css:["ccm.load","https://ccmjs.github.io/tkless-components/pdf_viewer/resources/styles.min.css","https://ccmjs.github.io/tkless-components/libs/bootstrap-5/css/bootstrap-icons.min.css",{url:"https://ccmjs.github.io/tkless-components/libs/bootstrap-5/css/bootstrap-fonts.min.css",context:"head"}],dark:"auto",downloadable:true,helper:["ccm.load","https://ccmjs.github.io/akless-components/modules/versions/helper-8.0.0.min.mjs"],html:["ccm.load","https://ccmjs.github.io/tkless-components/pdf_viewer/resources/templates.mjs"],page:1,pdf:"https://ccmjs.github.io/tkless-components/pdf_viewer/resources/demo/de/slides.pdf",pdfjs:{lib:["ccm.load","https://ccmjs.github.io/tkless-components/libs/pdfjs-2/pdf.min.js"],worker:["ccm.load","https://ccmjs.github.io/tkless-components/libs/pdfjs-2/pdf.worker.min.js"],namespace:"pdfjs-dist/build/pdf"},text:["ccm.load","https://ccmjs.github.io/tkless-components/pdf_viewer/resources/resources.mjs#en"]},Instance:function(){let $;let file;let page_nr;let rendering=false;this.init=async()=>{$=Object.assign({},this.ccm.helper,this.helper);$.use(this.ccm);const pdfjs=window[this.pdfjs.namespace];if(!pdfjs.GlobalWorkerOptions.workerSrc)pdfjs.GlobalWorkerOptions.workerSrc=this.pdfjs.worker;this.pdfjs=pdfjs};this.ready=async()=>{this.routing&&this.routing.define({page:number=>{page_nr=number;renderPage()}});this.element.addEventListener("keydown",(event=>{switch(event.key){case"ArrowLeft":events.onPrev();break;case"ArrowRight":events.onNext();break;case"ArrowUp":events.onFirst();break;case"ArrowDown":events.onLast();break}}));$.touchControl(this.element,{onLeft:events.onPrev,onRight:events.onNext});this.dark==="auto"&&this.element.classList.add("dark_auto");this.dark===true&&this.element.classList.add("dark_mode");this.logger&&this.logger.log("ready",$.privatize(this,true))};this.start=async()=>{try{file=await this.pdfjs.getDocument(this.pdf).promise}catch(exception){if(exception.name!=="PasswordException")return $.setContent(this.element,"");try{file=await this.pdfjs.getDocument({url:this.pdf,password:prompt(this.text.protected)}).promise}catch(e){}if(!file)return $.setContent(this.element,this.text.denied)}this.logger&&this.logger.log("start");render();this.lang&&!this.lang.getContext()&&$.append(this.element.querySelector("header"),this.lang.root);const header=this.element.querySelector("header");if(header){header&&this.lang&&!this.lang.getContext()&&$.append(header,this.lang.root);header&&this.user&&$.append(header,this.user.root)}const canvas=this.element.querySelector("canvas");!this.downloadable&&canvas&&canvas.addEventListener("contextmenu",(event=>event.preventDefault()));page_nr=this.page;if(this.routing&&this.routing.get())await this.routing.refresh();else await renderPage()};this.goTo=async page=>{if(page<1||page>file.numPages)return;page_nr=page;this.routing&&this.routing.set("page-"+page_nr);await renderPage();this.logger&&this.logger.log("goto",page_nr)};this.getPage=()=>page_nr;this.getPages=()=>file.numPages;this.onbreakpoint=this.refresh=()=>renderPage();const render=()=>{this.html.render(this.html.main(this,events,page_nr,file.numPages),this.element);this.lang&&this.lang.translate()};const renderPage=async no_refresh=>{if(rendering)return;rendering=true;const canvas=this.element.querySelector("canvas");if(!canvas){rendering=false;return}const page=await file.getPage(page_nr);const viewport=page.getViewport({scale:canvas.clientWidth/page.getViewport({scale:1}).width});canvas.height=viewport.height;canvas.width=viewport.width;await render();await page.render({canvasContext:canvas.getContext("2d"),viewport:viewport}).promise;rendering=false;!no_refresh&&$.sleep(300).then((()=>renderPage(true)))};const events={onFirst:async()=>{if(this.onchange&&await this.onchange({name:"first",page:page_nr,instance:this,before:true}))return;if(page_nr<=1)return;await this.goTo(page_nr=1);this.onchange&&this.onchange({name:"first",page:page_nr,instance:this})},onPrev:async()=>{if(this.onchange&&await this.onchange({name:"prev",page:page_nr,instance:this,before:true}))return;if(page_nr<=1)return;await this.goTo(--page_nr);this.onchange&&this.onchange({name:"prev",page:page_nr,instance:this})},onJump:async event=>{const page=parseInt(event.target.value);event.target.value="";if(this.onchange&&await this.onchange({name:"jump",page:page,instance:this,before:true}))return;if(!page||page<1||page>file.numPages||page===page_nr)return;await this.goTo(page);this.onchange&&this.onchange({name:"jump",page:page,instance:this})},onNext:async()=>{if(this.onchange&&await this.onchange({name:"next",page:page_nr,instance:this,before:true}))return;if(page_nr>=file.numPages)return;await this.goTo(++page_nr);this.onchange&&this.onchange({name:"next",page:page_nr,instance:this})},onLast:async()=>{if(this.onchange&&await this.onchange({name:"last",page:page_nr,instance:this,before:true}))return;if(page_nr>=file.numPages)return;await this.goTo(page_nr=file.numPages);this.onchange&&this.onchange({name:"last",page:page_nr,instance:this})}}}};let b="ccm."+component.name+(component.version?"-"+component.version.join("."):"")+".js";if(window.ccm&&null===window.ccm.files[b])return window.ccm.files[b]=component;(b=window.ccm&&window.ccm.components[component.name])&&b.ccm&&(component.ccm=b.ccm);"string"===typeof component.ccm&&(component.ccm={url:component.ccm});let c=(component.ccm.url.match(/(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)/)||[""])[0];if(window.ccm&&window.ccm[c])window.ccm[c].component(component);else{var a=document.createElement("script");document.head.appendChild(a);component.ccm.integrity&&a.setAttribute("integrity",component.ccm.integrity);component.ccm.crossorigin&&a.setAttribute("crossorigin",component.ccm.crossorigin);a.onload=function(){(c="latest"?window.ccm:window.ccm[c]).component(component);document.head.removeChild(a)};a.src=component.ccm.url}})();
//# sourceMappingURL=ccm.pdf_viewer-7.2.0.min.js.map